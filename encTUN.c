#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -Uvr -m CONTACT @TUNBudi06 at TeleGram -f encTUN.sh -o tun 
#endif

static  char data [] = 
#define      inlo_z	3
#define      inlo	((&data[0]))
	"\023\137\024"
#define      shll_z	10
#define      shll	((&data[4]))
	"\135\304\152\265\257\266\202\041\070\053\306\051\275"
#define      date_z	1
#define      date	((&data[16]))
	"\343"
#define      tst2_z	19
#define      tst2	((&data[21]))
	"\104\353\253\124\333\166\240\214\017\320\051\035\275\200\373\117"
	"\350\277\127\071\067\372\264\357"
#define      msg1_z	44
#define      msg1	((&data[48]))
	"\111\274\161\107\237\303\124\024\116\200\326\044\176\177\221\012"
	"\074\222\233\122\133\342\143\137\345\324\124\041\220\322\227\212"
	"\072\251\110\376\254\023\203\037\266\000\302\322\203\310\345\333"
	"\251\301\134\263\023\105"
#define      msg2_z	19
#define      msg2	((&data[96]))
	"\212\240\264\211\027\073\260\004\127\335\227\307\323\310\231\036"
	"\132\007\130\243\257\010\110\322"
#define      chk2_z	19
#define      chk2	((&data[121]))
	"\311\325\121\321\000\132\345\252\322\273\104\037\360\100\075\155"
	"\107\334\047\324\104\365\265\201"
#define      xecc_z	15
#define      xecc	((&data[145]))
	"\363\357\150\021\352\054\314\120\223\057\350\174\137\320\224\341"
	"\146\340\260"
#define      lsto_z	1
#define      lsto	((&data[162]))
	"\340"
#define      tst1_z	22
#define      tst1	((&data[165]))
	"\067\302\212\315\244\217\106\361\312\254\347\306\255\263\064\330"
	"\165\103\375\212\376\254\307\157"
#define      rlax_z	1
#define      rlax	((&data[187]))
	"\070"
#define      chk1_z	22
#define      chk1	((&data[189]))
	"\162\042\113\343\076\045\333\006\005\374\201\004\075\306\027\143"
	"\154\250\027\165\162\121\140\013\212\344"
#define      opts_z	1
#define      opts	((&data[214]))
	"\262"
#define      text_z	6032
#define      text	((&data[271]))
	"\373\256\322\357\236\263\240\000\333\360\044\130\364\134\032\223"
	"\346\273\274\037\145\056\052\357\023\346\103\316\230\114\011\224"
	"\373\334\203\232\220\044\232\154\024\276\304\010\033\337\234\001"
	"\233\130\040\000\207\113\357\233\133\170\232\344\377\047\147\073"
	"\004\220\235\074\231\305\236\301\200\341\326\204\343\031\010\317"
	"\053\044\242\107\153\377\064\342\237\213\214\141\176\230\216\041"
	"\364\300\216\222\271\362\111\244\203\266\025\310\326\077\146\113"
	"\350\173\266\227\177\276\254\107\024\105\154\115\036\225\246\377"
	"\174\262\352\037\031\265\331\376\237\171\044\047\255\031\270\072"
	"\057\356\240\221\245\072\363\126\362\011\221\175\104\067\002\105"
	"\250\172\003\375\133\264\330\064\153\146\011\211\053\322\251\275"
	"\225\102\205\014\302\135\354\101\002\161\043\361\122\350\146\373"
	"\144\312\315\255\122\110\257\173\134\027\372\216\273\340\367\062"
	"\023\326\163\203\140\234\220\330\120\207\373\025\030\062\045\050"
	"\221\227\077\260\003\363\367\100\051\335\203\145\153\336\341\052"
	"\316\300\133\165\042\352\075\315\317\224\212\326\206\246\301\323"
	"\142\157\150\011\146\171\175\216\267\125\023\360\330\154\126\300"
	"\322\017\243\114\102\346\211\055\303\027\377\034\302\104\222\041"
	"\303\251\051\265\025\360\251\364\276\362\165\101\103\062\141\056"
	"\313\226\342\101\100\027\326\374\026\044\217\305\177\241\240\303"
	"\365\352\357\306\313\324\341\206\247\054\030\134\035\072\317\360"
	"\025\150\103\175\100\065\066\124\027\033\263\244\055\056\175\372"
	"\112\041\121\037\213\111\071\267\037\325\267\140\154\227\167\320"
	"\212\371\370\227\064\245\166\017\213\144\051\376\212\252\052\156"
	"\144\374\357\112\203\064\130\211\112\064\101\334\040\326\362\157"
	"\376\377\205\341\044\153\000\305\070\234\236\105\262\071\344\273"
	"\334\376\127\077\235\361\200\034\301\123\102\206\145\016\216\363"
	"\151\174\335\010\023\012\244\224\025\024\147\113\002\376\176\270"
	"\217\240\123\201\023\100\372\245\250\170\052\073\035\047\343\213"
	"\174\153\337\174\365\163\116\247\235\037\362\162\116\140\374\110"
	"\252\204\161\351\172\203\043\255\146\051\154\276\210\053\032\340"
	"\163\371\157\124\021\260\021\255\215\077\347\376\316\354\272\122"
	"\315\361\125\272\113\327\226\255\054\231\333\325\265\044\036\062"
	"\114\174\000\142\075\166\105\073\362\223\246\031\112\117\305\253"
	"\336\040\315\076\204\043\266\132\254\134\024\347\352\262\133\252"
	"\162\170\154\016\220\153\276\074\115\245\345\113\046\132\144\341"
	"\315\352\023\237\266\120\307\254\110\206\207\245\074\306\174\343"
	"\321\067\221\251\071\000\323\162\173\155\011\347\034\043\364\345"
	"\266\357\113\207\332\377\111\106\014\215\134\362\172\177\372\260"
	"\065\367\101\213\254\245\044\107\125\012\302\215\320\377\136\126"
	"\207\255\377\274\267\101\012\207\275\217\337\133\062\336\133\214"
	"\067\176\342\043\013\317\000\214\123\253\276\163\001\230\171\116"
	"\255\277\226\227\354\130\330\177\154\012\116\130\051\013\000\025"
	"\120\065\024\315\354\036\256\221\021\334\221\027\313\305\335\275"
	"\101\250\043\035\135\031\047\117\245\161\302\345\175\134\102\050"
	"\123\261\062\013\253\234\326\126\132\113\210\127\245\053\052\375"
	"\313\106\145\327\232\123\127\333\225\105\337\206\010\373\106\152"
	"\375\077\163\073\201\210\265\206\112\352\215\047\131\332\243\036"
	"\135\300\110\064\306\177\330\160\027\025\340\235\371\101\357\056"
	"\211\204\057\154\122\125\054\140\352\036\044\046\157\354\355\221"
	"\030\016\060\163\154\276\346\212\335\113\221\314\145\130\121\157"
	"\050\071\176\121\247\351\170\234\127\272\060\143\241\027\331\370"
	"\010\207\304\061\327\237\237\060\224\073\305\361\044\205\002\347"
	"\265\332\046\171\372\353\010\207\243\174\331\255\141\336\230\155"
	"\304\053\363\056\160\371\267\267\243\234\164\317\267\143\306\213"
	"\136\261\372\311\135\236\151\242\237\140\034\141\071\021\276\356"
	"\040\324\360\212\172\347\141\022\371\136\172\043\014\100\171\220"
	"\270\204\053\107\004\372\311\002\124\231\204\343\313\312\330\167"
	"\025\242\237\022\013\166\066\055\240\306\011\213\142\011\331\033"
	"\133\345\164\075\260\240\315\376\202\067\266\374\374\201\266\314"
	"\314\126\315\072\324\333\014\342\264\372\262\144\030\336\230\325"
	"\137\326\213\111\167\225\120\226\355\025\061\214\307\025\053\033"
	"\164\335\235\237\166\156\005\066\352\316\351\201\042\120\170\005"
	"\001\074\151\200\065\105\356\277\154\014\312\146\344\030\176\360"
	"\346\134\132\074\334\267\000\362\374\156\356\073\154\123\035\114"
	"\020\136\365\272\112\210\102\202\025\277\335\270\127\004\071\326"
	"\363\023\235\250\325\255\123\151\143\314\021\161\352\077\317\123"
	"\244\237\370\260\344\364\223\234\362\213\214\353\051\051\205\075"
	"\304\234\036\065\105\311\106\375\112\242\010\267\177\156\064\134"
	"\200\354\210\053\071\012\137\140\047\352\046\073\334\025\272\054"
	"\072\005\156\326\153\242\313\307\057\356\356\361\104\161\121\105"
	"\352\334\304\277\047\361\343\060\116\236\317\232\374\015\143\142"
	"\241\325\235\267\223\322\051\117\160\024\024\203\141\063\064\342"
	"\040\131\241\352\167\363\241\263\212\242\331\017\062\101\113\066"
	"\005\137\315\212\164\074\050\035\315\232\344\030\005\334\047\355"
	"\362\336\262\361\012\021\350\307\070\304\145\027\240\215\361\373"
	"\331\116\206\376\341\076\302\303\376\225\243\041\131\142\260\224"
	"\240\362\172\006\361\141\050\102\366\246\023\323\175\101\112\014"
	"\250\017\157\366\073\333\277\372\313\213\077\323\217\357\024\066"
	"\013\356\057\311\371\204\046\372\360\112\304\062\275\300\221\324"
	"\055\334\147\075\122\314\203\140\117\346\032\306\302\113\211\333"
	"\057\053\245\231\223\313\100\020\347\372\202\135\042\077\110\130"
	"\242\013\171\161\271\327\033\162\224\044\106\347\134\036\325\201"
	"\132\001\211\167\302\257\035\246\370\112\274\202\361\017\252\245"
	"\214\002\156\326\143\100\253\233\226\202\301\155\042\133\123\271"
	"\315\111\072\074\054\310\334\251\336\101\157\016\021\001\045\067"
	"\377\335\223\331\334\072\360\226\222\223\322\256\020\237\217\002"
	"\307\142\062\206\113\206\066\316\373\354\022\072\162\060\016\246"
	"\164\067\001\154\335\106\012\036\334\041\117\233\336\113\261\013"
	"\231\223\220\326\123\265\126\337\013\043\164\056\266\141\270\337"
	"\264\043\344\075\155\276\012\112\164\323\145\200\042\307\202\112"
	"\023\035\143\130\124\163\330\240\351\142\375\272\314\256\221\070"
	"\217\322\311\171\155\270\134\143\213\176\301\015\262\276\174\075"
	"\055\216\372\150\212\127\241\170\122\212\365\066\322\363\007\110"
	"\140\016\322\074\014\031\006\364\145\124\164\250\043\023\106\070"
	"\261\246\373\344\003\072\115\116\246\216\072\217\031\225\117\173"
	"\333\275\371\211\020\220\043\077\036\362\060\377\032\167\115\243"
	"\272\264\027\033\334\270\046\220\047\153\071\134\252\363\126\063"
	"\270\012\303\243\024\145\065\222\364\063\107\225\144\050\340\352"
	"\373\024\374\353\017\265\143\043\271\203\115\045\055\350\034\256"
	"\224\133\032\135\067\042\167\340\373\046\025\164\142\204\211\027"
	"\322\361\302\121\324\067\004\202\007\035\351\376\104\052\077\315"
	"\001\306\004\056\004\222\317\251\051\070\042\076\362\104\245\105"
	"\147\342\371\266\277\152\363\253\216\170\307\322\254\332\220\244"
	"\043\335\161\270\050\370\124\330\026\131\257\311\104\031\337\042"
	"\054\160\160\240\267\300\347\350\127\071\077\050\107\377\262\326"
	"\114\254\142\307\225\213\035\251\157\140\307\033\001\073\031\010"
	"\277\050\201\076\141\025\344\362\243\224\013\073\073\360\322\122"
	"\003\262\072\345\370\211\163\132\131\150\021\261\202\013\062\074"
	"\377\272\221\255\206\152\066\170\132\124\361\036\023\122\266\030"
	"\353\167\322\354\201\110\302\335\146\007\036\045\317\214\115\240"
	"\165\061\307\162\272\217\036\132\147\227\332\205\203\347\347\376"
	"\113\274\352\321\360\205\374\017\334\005\371\307\134\064\330\043"
	"\075\076\222\264\363\364\053\176\333\301\115\232\063\160\156\065"
	"\073\276\056\252\376\102\354\242\043\373\050\155\060\361\177\252"
	"\365\134\051\111\262\152\035\037\107\117\216\115\311\012\045\256"
	"\021\301\177\371\110\044\350\362\254\221\251\230\246\330\103\243"
	"\214\111\051\264\063\173\324\225\325\062\174\250\161\227\237\277"
	"\113\076\255\331\314\276\110\074\264\005\154\144\241\030\134\016"
	"\153\221\337\313\353\316\011\054\362\167\335\017\212\142\243\305"
	"\061\256\030\153\062\361\140\061\076\152\106\261\141\006\345\111"
	"\277\076\310\212\247\300\077\236\152\211\133\264\201\123\026\227"
	"\256\123\245\245\211\274\272\341\012\165\376\226\031\331\235\207"
	"\201\046\074\362\121\022\273\063\114\147\142\260\334\132\375\070"
	"\047\330\143\054\145\146\354\125\233\301\337\234\374\236\237\025"
	"\153\150\334\074\263\162\172\134\172\021\240\312\143\060\037\152"
	"\072\161\070\170\226\242\064\261\251\322\173\367\025\007\025\130"
	"\374\212\033\167\230\174\162\066\170\006\357\126\136\055\263\154"
	"\341\103\076\215\074\335\070\104\033\220\033\032\146\006\253\001"
	"\027\223\262\273\313\072\163\133\336\131\260\207\026\047\104\266"
	"\247\216\075\166\372\003\364\274\216\334\126\304\364\363\315\307"
	"\160\324\066\174\272\020\111\065\347\321\213\354\160\250\001\157"
	"\120\070\327\326\357\262\076\345\126\355\051\222\303\273\354\316"
	"\021\021\242\361\317\216\342\374\131\352\375\327\110\102\001\164"
	"\156\130\240\060\300\334\153\317\074\337\163\173\356\372\245\337"
	"\066\015\142\253\355\036\032\100\244\211\016\030\306\153\000\045"
	"\116\230\054\350\066\210\346\206\320\034\106\257\147\377\344\052"
	"\327\065\230\075\244\072\034\243\246\157\210\147\154\055\027\314"
	"\172\330\142\333\262\344\351\104\362\247\022\066\146\000\100\150"
	"\243\134\372\050\346\027\025\211\125\214\357\022\001\125\253\246"
	"\326\261\256\100\145\105\202\005\135\101\105\232\071\271\210\136"
	"\151\076\101\227\300\170\341\301\345\074\341\104\142\010\325\275"
	"\105\326\364\372\262\101\112\010\111\126\162\073\125\142\121\067"
	"\360\030\156\323\214\001\320\135\042\013\107\301\316\140\345\156"
	"\007\152\131\163\342\167\057\361\127\046\266\015\310\172\062\247"
	"\257\076\162\031\257\114\115\273\126\306\341\111\331\156\171\330"
	"\230\353\372\246\313\101\066\172\245\074\056\163\163\241\332\346"
	"\237\253\206\127\043\340\300\264\353\327\052\115\104\204\110\002"
	"\110\246\305\147\306\052\377\160\103\042\261\115\316\157\262\135"
	"\167\005\122\336\011\171\135\070\127\333\214\302\013\026\261\175"
	"\201\362\162\263\057\031\075\312\223\010\032\226\223\144\074\006"
	"\143\315\147\125\210\323\120\163\241\277\126\034\022\022\160\073"
	"\123\217\353\007\213\137\101\045\022\145\146\145\027\217\304\244"
	"\327\173\220\230\142\122\062\217\240\011\314\120\034\023\355\101"
	"\022\163\277\206\332\241\154\315\210\102\203\056\376\015\323\110"
	"\173\312\251\134\247\120\341\270\372\003\116\202\234\162\201\054"
	"\217\132\265\355\366\354\006\333\247\044\053\113\251\374\357\063"
	"\071\070\345\041\344\106\361\076\336\255\064\260\340\171\016\365"
	"\177\110\000\023\026\315\066\114\336\225\133\260\022\122\106\376"
	"\001\200\010\224\131\050\340\025\102\345\232\325\105\357\275\343"
	"\146\064\145\173\344\066\173\346\016\177\275\223\173\341\155\275"
	"\073\353\050\036\224\011\051\165\364\365\264\040\147\146\001\131"
	"\102\140\116\137\322\141\035\130\223\105\016\333\174\012\075\345"
	"\147\265\022\142\230\066\006\213\225\315\157\001\301\162\150\304"
	"\056\263\132\142\377\374\027\045\173\272\145\244\004\104\116\135"
	"\313\004\032\156\375\040\122\342\074\031\236\241\126\322\130\054"
	"\023\374\030\033\265\204\365\041\360\362\241\120\117\206\256\277"
	"\154\365\213\122\034\264\156\004\146\357\162\071\031\037\300\157"
	"\117\030\031\066\175\011\134\057\205\125\037\351\032\151\317\075"
	"\253\267\373\132\316\000\170\365\037\366\271\311\140\060\022\232"
	"\171\141\376\133\357\041\355\350\000\132\002\377\275\145\230\000"
	"\002\217\032\202\206\207\253\053\323\363\367\055\000\271\344\224"
	"\100\212\054\167\160\272\024\331\065\356\225\212\301\366\246\214"
	"\022\121\343\353\252\023\060\373\051\005\257\314\235\111\110\324"
	"\171\024\003\153\215\357\225\112\043\244\357\046\334\054\240\223"
	"\052\024\260\353\037\315\135\062\342\304\033\145\376\257\341\032"
	"\317\046\056\274\267\161\006\171\355\105\273\066\005\244\065\137"
	"\344\347\252\337\274\176\145\325\054\015\355\111\015\252\016\062"
	"\146\365\351\322\071\223\234\141\046\235\162\342\305\217\257\260"
	"\072\276\131\150\167\236\264\120\163\337\205\024\364\323\200\343"
	"\070\265\041\355\346\010\211\032\233\255\055\322\210\170\011\013"
	"\044\150\360\346\205\365\055\026\151\034\130\343\053\237\302\005"
	"\165\027\163\124\163\326\120\145\223\056\161\273\204\227\052\141"
	"\365\246\147\150\143\315\150\173\243\057\254\057\343\306\164\254"
	"\027\164\134\376\302\121\153\170\136\062\301\167\144\361\357\314"
	"\353\163\076\220\145\055\320\201\234\026\260\332\157\251\100\050"
	"\336\331\233\311\117\150\225\305\137\025\207\154\353\350\035\023"
	"\042\334\007\240\205\306\335\236\344\211\001\035\057\322\133\117"
	"\206\007\021\102\247\303\362\022\204\322\212\246\077\044\133\240"
	"\035\116\141\152\205\024\370\111\056\357\214\305\250\227\375\273"
	"\211\166\157\077\344\210\113\212\164\011\025\126\223\036\366\037"
	"\175\053\057\167\212\352\352\154\313\263\313\155\105\312\377\333"
	"\207\040\123\312\100\343\067\212\116\134\016\334\052\155\165\353"
	"\363\221\021\175\372\114\337\341\307\102\066\314\145\243\306\243"
	"\277\052\332\325\230\370\022\207\037\040\127\124\276\264\246\313"
	"\037\342\007\221\042\321\365\003\242\351\355\027\371\201\241\313"
	"\235\377\014\134\250\352\020\350\074\242\056\051\333\017\226\054"
	"\145\031\264\247\332\051\074\245\001\147\104\305\160\231\044\032"
	"\271\105\357\134\250\107\116\346\132\111\262\251\303\203\064\002"
	"\017\113\126\214\246\367\215\077\327\162\135\101\114\105\366\027"
	"\210\077\310\344\326\072\240\143\241\352\222\062\366\011\033\115"
	"\365\001\321\323\267\264\150\312\217\337\241\311\231\230\022\340"
	"\134\315\134\021\216\006\121\112\123\134\045\232\376\173\145\304"
	"\167\160\021\172\107\376\255\002\160\152\342\076\003\133\212\310"
	"\025\166\134\057\360\237\322\362\162\161\232\225\261\360\146\126"
	"\233\330\074\317\307\134\123\116\010\314\154\016\362\175\263\253"
	"\023\032\037\327\153\022\315\264\017\354\136\064\117\324\350\034"
	"\154\274\044\001\131\331\170\340\264\323\255\061\276\013\347\330"
	"\144\365\303\220\324\337\215\367\257\272\226\156\325\236\236\210"
	"\220\327\231\341\252\354\106\073\020\003\151\074\023\072\164\102"
	"\003\171\060\316\363\030\257\050\327\047\030\244\206\101\052\222"
	"\107\373\055\067\243\036\177\152\225\057\370\377\370\370\055\140"
	"\013\163\152\330\314\013\207\214\174\167\236\147\075\231\373\136"
	"\017\141\351\206\204\343\033\376\347\143\342\345\155\244\302\163"
	"\323\270\260\172\261\067\137\317\051\266\313\047\267\260\354\112"
	"\163\105\121\337\062\041\117\254\176\071\121\047\213\220\032\006"
	"\116\265\067\300\202\374\271\204\225\151\101\155\237\373\342\224"
	"\145\047\200\053\375\365\317\063\027\234\231\314\225\050\064\356"
	"\011\052\063\373\253\121\203\141\124\070\347\240\253\216\247\134"
	"\302\322\107\311\247\040\220\303\104\120\363\124\322\332\006\242"
	"\105\010\361\253\106\127\125\207\123\332\227\243\056\076\227\171"
	"\222\261\114\320\250\152\037\275\372\100\020\214\131\043\165\055"
	"\207\115\252\351\114\064\200\156\043\310\246\162\202\342\056\145"
	"\144\151\346\373\012\036\322\360\035\161\342\304\300\055\365\264"
	"\102\371\034\260\025\034\256\360\070\014\314\162\374\201\135\307"
	"\042\207\000\155\100\220\305\351\016\043\000\304\355\125\172\361"
	"\204\366\333\211\032\303\246\202\345\243\160\227\217\152\006\261"
	"\147\025\305\360\336\366\022\164\032\067\324\020\177\172\337\135"
	"\165\214\021\365\120\377\346\327\121\217\271\342\366\175\236\067"
	"\140\171\235\101\212\060\241\035\152\326\175\206\027\332\373\304"
	"\367\204\042\150\354\355\260\124\233\177\055\172\203\342\107\216"
	"\164\006\036\321\067\167\276\223\170\367\314\071\332\376\331\131"
	"\335\347\161\027\101\323\313\355\172\113\250\014\264\121\207\072"
	"\225\250\276\043\126\211\055\314\314\034\017\324\324\302\375\212"
	"\236\204\106\115\074\174\345\177\221\005\202\052\142\047\114\062"
	"\076\374\000\031\056\303\042\101\364\370\271\106\300\325\164\261"
	"\110\021\304\075\065\356\233\206\171\156\144\001\115\317\037\006"
	"\014\271\040\176\075\167\223\341\365\056\216\253\217\021\212\347"
	"\332\046\117\055\334\103\077\132\256\337\347\020\161\077\000\243"
	"\302\066\147\362\302\316\135\304\073\365\047\244\204\151\103\144"
	"\310\317\173\255\053\262\344\352\353\371\321\043\115\346\006\311"
	"\014\147\331\324\300\076\030\133\361\345\215\037\165\261\133\064"
	"\171\015\276\246\013\376\105\326\021\045\266\314\256\170\022\374"
	"\001\242\021\077\127\243\227\307\142\131\234\166\271\271\367\367"
	"\125\271\063\077\231\063\152\032\330\161\333\152\053\351\114\011"
	"\037\070\253\205\125\054\343\041\107\341\074\353\052\054\103\210"
	"\244\151\177\161\201\000\335\274\076\335\267\122\066\125\017\247"
	"\222\101\266\017\346\110\356\167\056\052\361\207\127\214\362\153"
	"\363\060\360\340\227\347\074\130\262\155\334\361\063\113\304\004"
	"\013\325\237\072\024\154\174\236\122\236\316\231\154\176\316\346"
	"\310\266\233\336\002\100\315\162\167\362\352\216\133\041\314\173"
	"\244\101\170\334\162\033\324\174\236\131\366\204\213\046\136\140"
	"\254\205\316\347\324\235\157\176\035\032\073\317\033\037\144\024"
	"\256\257\276\066\211\301\115\160\043\270\027\220\022\001\024\020"
	"\245\057\346\302\101\121\124\260\142\221\103\357\223\106\335\017"
	"\252\275\343\260\276\302\133\125\346\340\260\272\120\124\332\161"
	"\351\216\126\051\321\053\342\026\075\024\171\005\066\213\355\216"
	"\076\062\000\361\336\131\264\170\275\046\002\307\276\105\260\377"
	"\055\101\242\344\320\275\251\027\167\142\042\004\242\360\205\332"
	"\221\250\257\020\064\177\102\135\335\245\161\301\273\215\342\243"
	"\234\163\135\045\051\311\221\330\334\240\033\275\222\055\275\176"
	"\331\344\227\256\361\324\061\121\346\236\112\011\327\263\175\140"
	"\301\227\363\224\025\377\000\377\271\371\266\256\133\224\126\131"
	"\044\115\023\156\256\127\150\056\044\171\132\260\214\362\203\061"
	"\225\266\016\000\051\372\254\210\332\166\344\014\354\255\134\252"
	"\255\221\101\313\240\276\134\112\010\215\120\233\154\165\174\360"
	"\340\304\223\333\120\075\250\260\014\024\222\105\071\054\010\061"
	"\277\163\004\172\347\042\227\101\174\324\007\234\256\034\246\244"
	"\324\024\124\300\044\010\067\051\070\232\074\101\305\007\234\137"
	"\322\326\310\324\304\310\365\021\160\304\211\047\020\263\021\240"
	"\111\212\353\217\133\051\255\320\012\313\035\017\046\031\057\102"
	"\015\165\001\373\273\366\203\302\361\233\135\376\315\146\265\235"
	"\336\171\035\110\024\324\171\160\117\205\140\337\252\010\266\235"
	"\006\314\371\147\247\027\161\254\006\061\353\271\357\035\326\342"
	"\135\037\016\037\306\256\254\263\044\123\074\224\012\143\276\156"
	"\047\230\335\106\313\054\361\166\071\170\133\364\312\151\105\203"
	"\351\060\324\207\133\121\347\351\325\372\223\013\260\334\157\265"
	"\325\247\001\324\024\123\152\160\314\177\226\252\362\202\223\134"
	"\343\307\175\373\146\326\165\006\242\225\367\063\123\140\227\140"
	"\217\063\150\231\243\033\354\065\043\211\070\203\117\024\143\006"
	"\140\041\321\276\044\350\241\235\133\124\375\157\357\224\245\250"
	"\053\370\314\134\354\160\033\254\060\006\105\123\110\073\352\377"
	"\076\076\307\322\302\150\200\155\132\310\032\211\307\370\037\073"
	"\242\137\061\136\260\131\273\347\135\031\370\165\310\272\254\212"
	"\244\311\173\031\226\327\065\344\000\212\033\055\241\260\365\042"
	"\025\142\176\030\343\033\027\200\171\002\302\017\201\347\177\033"
	"\146\137\127\165\123\022\036\067\326\140\254\221\043\326\276\017"
	"\353\172\006\202\072\070\361\334\243\161\110\206\263\114\213\132"
	"\270\151\340\124\134\172\101\145\207\012\362\137\317\105\016\123"
	"\371\055\267\371\064\221\324\161\035\174\063\100\151\205\017\304"
	"\266\044\104\042\321\314\121\233\346\015\264\340\042\377\266\161"
	"\301\303\325\203\200\175\032\360\356\176\242\073\311\043\047\020"
	"\320\043\352\342\254\102\354\220\326\105\275\013\243\156\147\133"
	"\263\215\155\371\003\272\134\276\362\235\262\231\005\330\241\101"
	"\331\311\147\275\135\152\066\233\122\043\335\167\312\127\043\363"
	"\325\124\351\056\121\257\351\340\223\341\337\314\050\351\025\141"
	"\040\303\344\142\225\342\062\143\300\153\333\322\201\143\272\316"
	"\234\056\043\003\045\267\021\156\131\265\276\051\331\225\161\054"
	"\072\077\101\136\155\120\120\007\102\262\242\160\052\117\030\233"
	"\046\216\154\167\023\344\357\346\150\220\254\340\035\251\200\076"
	"\016\014\021\061\343\206\002\343\351\276\214\372\001\213\030\100"
	"\136\135\320\124\353\031\042\020\073\357\227\003\244\244\103\030"
	"\163\335\042\033\004\150\212\131\062\070\117\335\323\241\233\035"
	"\377\315\067\142\152\257\320\274\161\246\012\066\313\217\200\226"
	"\216\275\133\153\167\234\343\143\273\332\375\351\007\242\336\316"
	"\132\224\310\174\153\044\102\121\056\200\310\205\331\032\055\340"
	"\055\242\175\224\301\023\235\012\102\162\351\316\126\062\351\223"
	"\166\011\362\371\064\027\242\147\064\276\377\321\360\077\046\026"
	"\012\126\154\361\027\025\233\104\307\355\145\046\260\072\267\247"
	"\042\100\052\334\276\062\273\057\026\354\044\150\242\276\247\326"
	"\125\071\175\235\261\077\224\232\154\312\013\261\350\156\302\371"
	"\150\060\332\133\321\217\377\053\215\134\200\263\253\220\041\115"
	"\364\207\225\314\132\017\211\120\367\155\010\014\271\136\107\305"
	"\364\016\354\063\356\114\327\112\322\341\371\365\045\047\243\112"
	"\227\203\157\154\035\312\061\173\235\025\171\201\253\022\040\001"
	"\374\322\344\273\362\110\344\063\340\275\174\365\164\325\317\310"
	"\064\354\341\041\154\243\247\017\076\236\241\266\135\310\233\210"
	"\042\255\074\342\134\010\250\022\057\217\067\026\176\042\116\144"
	"\313\362\122\376\071\245\241\131\217\063\340\035\155\043\040\373"
	"\303\063\275\340\310\263\311\355\060\315\304\246\207\342\243\272"
	"\303\111\145\054\215\260\231\156\326\127\270\377\367\265\141\313"
	"\221\307\032\053\027\235\173\011\143\056\164\253\230\203\061\330"
	"\363\005\277\265\070\370\253\072\044\276\014\062\232\066\006\122"
	"\034\106\176\076\322\132\254\033\252\172\372\247\127\051\013\347"
	"\212\011\153\362\001\125\275\124\243\377\060\343\204\107\301\302"
	"\143\254\362\065\204\012\160\042\346\216\231\015\105\174\011\032"
	"\277\344\030\275\024\036\207\332\253\342\222\365\075\335\321\246"
	"\141\152\307\261\243\152\162\365\327\226\307\043\334\114\267\003"
	"\356\052\164\123\244\332\336\327\024\100\270\322\207\161\245\071"
	"\271\057\102\160\302\261\161\205\254\377\170\104\211\376\255\331"
	"\312\353\215\120\333\132\331\076\371\241\332\167\367\351\325\355"
	"\250\324\157\247\006\202\026\154\210\110\225\306\254\027\077\233"
	"\102\114\324\104\227\255\215\302\263\356\344\252\255\311\130\133"
	"\017\121\057\070\074\132\363\312\257\175\102\316\130\302\163\017"
	"\110\322\071\217\173\324\202\034\245\136\220\112\365\211\112\146"
	"\246\213\167\316\101\172\031\315\025\121\324\351\037\120\064\201"
	"\247\017\234\251\173\152\057\364\266\355\067\204\062\123\320\066"
	"\270\102\042\152\023\205\332\306\172\045\362\275\031\204\345\105"
	"\052\022\065\231\240\303\016\052\017\261\024\260\072\155\274\024"
	"\262\374\277\205\264\052\157\311\350\345\275\337\333\133\154\125"
	"\166\201\367\006\102\052\317\317\376\226\134\153\315\323\234\264"
	"\341\020\145\145\125\126\140\367\263\222\364\303\041\077\304\066"
	"\347\170\204\224\047\162\015\344\162\130\167\211\203\365\003\022"
	"\077\120\116\037\353\312\230\365\055\032\275\324\134\351\255\205"
	"\374\153\321\353\300\245\313\024\372\322\007\110\034\120\164\227"
	"\371\145\305\145\157\325\120\372\306\275\214\003\013\107\104\171"
	"\104\315\100\357\065\250\324\001\063\163\052\333\010\120\126\143"
	"\132\325\305\347\106\030\160\035\061\165\172\104\035\067\240\351"
	"\370\107\173\133\172\212\161\065\311\101\026\137\306\137\252\356"
	"\112\146\131\277\051\147\071\272\363\064\135\267\105\346\250\004"
	"\261\162\330\364\373\332\157\236\336\336\102\010\074\045\257\314"
	"\045\165\003\040\015\345\020\266\270\167\005\057\155\147\314\112"
	"\372\144\111\050\056\332\071\167\354\212\066\325\300\240\074\144"
	"\043\260\373\175\372\215\016\262\371\012\361\366\151\176\073\004"
	"\260\056\333\066\366\346\127\333\323\170\251\323\151\341\210\132"
	"\324\157\232\354\325\324\064\266\157\122\075\361\212\352\351\071"
	"\206\266\371\244\377\271\052\257\326\277\116\107\147\321\205\234"
	"\327\223\330\170\050\054\075\156\161\241\367\102\324\325\001\203"
	"\216\362\154\172\360\373\355\237\215\133\204\162\304\112\244\157"
	"\237\010\232\053\034\116\150\254\237\062\243\012\265\367\225\353"
	"\255\230\375\145\176\345\155\251\164\350\256\260\004\123\002\313"
	"\200\210\230\021\120\154\160\363\375\076\301\355\112\251\205\132"
	"\034\210\136\252\306\136\376\267\117\015\164\310\054\166\325\342"
	"\323\027\164\304\176\226\314\054\241\243\347\175\224\347\062\361"
	"\054\240\050\354\307\271\343\032\201\357\154\072\241\170\252\035"
	"\227\171\135\374\064\201\330\252\136\012\270\222\172\324\113\167"
	"\010\056\015\231\135\333\353\100\244\146\224\256\203\143\222\357"
	"\247\104\246\043\210\365\140\102\357\044\370\312\343\252\357\216"
	"\037\132\044\256\100\330\023\117\017\243\066\130\134\103\230\054"
	"\367\345\260\136\360\126\251\253\035\027\016\326\000\220\350\220"
	"\052\300\317\244\262\255\202\333\044\130\075\307\055\313\065\231"
	"\266\335\377\070\236\355\316\253\001\005\250\050\255\256\313\250"
	"\213\375\156\233\373\135\157\204\027\332\261\056\322\175\207\121"
	"\016\166\136\101\304\145\024\271\360\342\050\003\302\003\126\324"
	"\105\006\351\044\062\136\312\241\300\113\166\022\330\016\115\302"
	"\266\063\043\336\061\332\276\251\262\033\230\172\346\005\116\355"
	"\226\353\155\136\025\364\002\140\355\033\247\200\174\242\230\136"
	"\334\322\153\144\135\240\243\374\137\062\352\044\035\033\036\271"
	"\157\223\015\204\335\043\262\046\333\020\202\031\074\236\346\337"
	"\276\016\150\356\110\276\161\301\210\142\231\040\253\220\140\240"
	"\225\375\360\231\107\055\313\227\062\063\151\313\177\163\137\173"
	"\117\343\025\340\007\257\114\034\156\020\045\212\360\301\213\213"
	"\031\254\214\241\367\174\074\051\257\245\365\057\030\124\252\150"
	"\070\300\110\100\160\224\134\336\245\201\151\225\102\364\041\133"
	"\240\256\375\230\052\071\302\331\337\267\011\370\014\263\140\104"
	"\164\251\204\344\076\340\303\344\142\054\171\244\041\233\000\302"
	"\111\375\132\163\067\035\115\026\324\126\016\340\012\157\045\176"
	"\031\252\143\127\213\046\073\355\122\265\221\164\121\222\066\233"
	"\217\220\016\306\255\134\335\202\263\353\143\275\133\211\074\164"
	"\063\237\314\276\305\010\254\030\276\076\214\017\320\302\253\137"
	"\123\271\046\001\026\003\204\311\357\347\207\113\160\303\300\244"
	"\143\214\142\051\225\017\101\124\115\316\144\035\221\017\175\345"
	"\311\243\347\337\247\153\251\227\122\061\342\303\365\242\147\130"
	"\057\312\201\305\331\303\031\046\221\175\104\043\214\301\010\125"
	"\145\357\065\015\132\337\244\255\020\206\160\005\051\330\136\130"
	"\242\337\035\173\242\067\242\064\264\347\127\101\250\140\227\016"
	"\120\315\033\253\254\300\131\275\106\312\302\160\242\040\311\104"
	"\000\346\300\243\036\143\327\322\112\057\024\363\220\254\001\341"
	"\171\035\214\045\335\345\343\044\257\245\225\121\306\136\226\307"
	"\104\127\152\143\273\102\066\005\162\112\371\003\366\373\344\157"
	"\030\160\225\366\126\170\033\006\036\260\127\345\016\356\255\123"
	"\106\027\266\001\132\354\006\315\067\000\320\055\373\265\235\023"
	"\046\063\012\174\254\045\202"
#define      pswd_z	256
#define      pswd	((&data[6708]))
	"\260\344\311\135\067\017\165\356\020\320\332\027\235\021\027\156"
	"\077\023\043\335\046\111\020\061\306\274\127\110\207\055\043\067"
	"\021\354\225\111\373\012\070\014\332\022\044\170\044\074\346\144"
	"\117\012\101\166\123\122\371\326\273\307\314\352\170\212\026\336"
	"\055\002\106\352\076\306\076\073\370\156\330\033\144\076\311\074"
	"\070\257\003\217\367\375\145\263\304\062\235\075\275\264\034\353"
	"\266\143\326\365\052\024\060\042\202\011\076\346\107\007\043\177"
	"\267\047\016\256\044\164\142\351\247\377\047\144\263\103\117\152"
	"\246\045\137\320\072\217\363\274\230\061\243\340\071\307\137\360"
	"\356\156\237\022\343\002\374\212\001\043\357\265\146\076\037\015"
	"\144\176\336\236\016\322\133\247\003\377\207\075\307\347\056\265"
	"\125\316\310\070\320\304\303\322\347\262\207\116\361\247\133\126"
	"\045\072\365\064\014\120\333\020\120\143\115\027\112\174\315\237"
	"\112\225\330\032\132\234\354\102\116\164\221\100\033\355\226\101"
	"\047\213\165\063\334\120\103\054\263\221\104\376\015\021\235\127"
	"\247\166\162\001\022\137\104\141\324\325\241\357\302\067\060\352"
	"\303\245\035\237\366\141\314\252\362\020\250\000\041\106\130\310"
	"\275\313\312\317\052\016\061\376\344\322\356\247\012\037\221\315"
	"\305\256\154\273\020\070\146\003\110\017\003\152\125\133\063\022"
	"\046\375\342\121\014\024\247\031\016\376\142\226\054\205\316\075"
	"\162\143\207\156\156\277\173\110\322\237\301\367\334\247\133\054"
	"\261\235\242\005\357\112\037\376\111\201\225\165\007\143\263\171"
	"\306\072\350\064\372\143\175\314\002\076\304\337\345"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * clang -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/data/data/com.termux/files/usr/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "clang";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/data/data/com.termux/files/usr/tmp/shc_x.so", "/data/data/com.termux/files/usr/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/data/data/com.termux/files/usr/tmp/shc_x.c"); return -1;}
	remove("/data/data/com.termux/files/usr/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/data/data/com.termux/files/usr/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/data/data/com.termux/files/usr/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
