#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -Uvr -f encTUN.sh -o /sdcard/encTUN.c 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[1]))
	"\122\306\157\207\364\233\343\126\277\120\041\373\126\110\305\045"
	"\216\234\354\377\165"
#define      rlax_z	1
#define      rlax	((&data[21]))
	"\222"
#define      text_z	5993
#define      text	((&data[1223]))
	"\074\341\232\051\220\247\335\227\174\254\217\042\164\023\003\271"
	"\126\032\046\106\264\167\236\007\354\125\330\153\051\245\160\145"
	"\207\012\217\027\261\155\256\055\031\076\117\216\122\122\107\251"
	"\155\156\357\041\345\216\050\322\343\001\076\014\247\256\162\056"
	"\270\002\106\151\157\365\227\211\063\346\027\206\071\137\057\246"
	"\315\037\310\263\255\360\205\220\362\303\235\231\161\017\310\052"
	"\021\016\223\201\003\053\012\067\021\042\275\113\201\354\362\117"
	"\013\272\002\270\253\210\111\235\113\346\067\275\366\377\347\010"
	"\015\173\211\021\246\224\110\270\266\005\003\067\362\365\207\375"
	"\260\212\266\133\022\000\371\135\347\061\033\335\060\002\345\076"
	"\175\156\120\043\002\230\333\271\235\337\361\220\325\170\215\206"
	"\002\104\341\024\105\333\162\054\015\215\011\075\220\357\174\016"
	"\136\314\062\141\145\016\032\002\355\013\223\303\203\040\111\206"
	"\145\053\233\252\007\015\326\024\233\340\122\054\317\316\072\055"
	"\233\154\216\000\172\251\003\150\264\226\053\070\267\164\276\035"
	"\237\132\307\247\147\236\273\003\177\015\057\116\334\152\174\167"
	"\326\013\170\121\264\173\271\150\022\345\241\311\131\140\346\371"
	"\272\256\240\042\114\134\046\313\151\126\032\105\300\226\275\227"
	"\242\065\351\126\260\242\277\303\210\141\214\341\301\162\333\174"
	"\041\174\236\155\330\305\071\102\033\124\207\334\353\105\163\215"
	"\172\135\343\053\000\243\356\210\004\173\151\306\356\105\102\017"
	"\302\340\175\232\245\266\335\301\012\145\235\365\252\021\203\045"
	"\156\147\120\156\012\077\366\017\272\140\325\251\246\027\270\150"
	"\370\065\003\236\354\340\137\367\105\375\355\357\016\160\025\175"
	"\327\145\353\342\245\342\361\140\102\307\011\350\336\301\121\327"
	"\367\124\166\343\065\325\332\172\323\307\152\342\070\177\137\020"
	"\345\113\362\212\055\343\352\157\253\364\130\211\265\251\141\254"
	"\376\327\220\063\255\153\256\200\063\030\143\153\230\302\173\175"
	"\015\155\010\072\121\363\252\374\347\002\206\235\254\350\111\253"
	"\277\332\336\155\105\214\355\170\245\121\343\075\023\137\273\040"
	"\315\303\133\036\266\005\033\236\010\242\073\265\212\205\140\112"
	"\137\076\267\244\313\245\035\160\366\000\255\012\140\151\052\055"
	"\054\206\113\343\214\147\202\224\012\275\112\225\102\252\337\242"
	"\351\227\107\264\074\144\044\063\145\322\075\305\073\150\362\150"
	"\356\076\114\172\245\316\017\257\213\131\104\316\004\044\161\355"
	"\273\270\241\370\034\306\053\202\231\151\107\325\321\071\075\300"
	"\170\211\073\035\127\113\315\343\245\022\261\251\067\043\226\362"
	"\333\070\353\370\376\026\172\230\200\302\155\122\374\252\022\164"
	"\064\116\221\213\231\137\156\076\162\040\350\251\103\176\233\037"
	"\266\207\027\265\236\222\115\036\125\273\160\121\145\203\305\231"
	"\322\127\045\153\267\224\252\051\265\222\322\371\021\156\030\310"
	"\365\060\176\223\303\314\262\030\207\042\151\355\246\057\206\170"
	"\206\254\344\075\101\217\147\366\042\071\360\063\250\010\373\235"
	"\071\172\061\375\106\343\025\315\006\177\272\254\257\101\045\066"
	"\356\011\164\057\230\333\046\272\025\026\356\275\037\352\133\130"
	"\144\214\125\252\160\153\170\166\353\062\043\232\164\110\320\142"
	"\121\104\222\352\040\270\245\065\316\223\362\355\175\115\106\342"
	"\332\234\214\112\007\005\300\363\070\344\215\254\054\136\017\176"
	"\243\241\151\303\131\016\371\047\241\353\025\037\070\133\001\023"
	"\367\216\135\377\223\036\362\313\002\200\170\056\337\207\255\203"
	"\050\026\107\202\044\100\252\306\053\277\346\144\033\347\167\023"
	"\166\325\023\011\363\006\325\365\207\116\044\146\325\322\352\376"
	"\351\061\201\015\162\053\324\235\353\273\002\006\242\172\032\031"
	"\117\055\043\103\063\370\071\272\106\135\041\034\060\013\033\031"
	"\075\234\047\257\307\374\115\263\267\117\272\132\312\324\163\031"
	"\002\226\134\065\217\225\360\326\363\022\363\044\035\016\075\133"
	"\252\145\012\162\141\127\045\030\247\340\162\161\264\345\213\266"
	"\174\350\354\014\176\335\342\161\357\325\226\015\344\323\150\216"
	"\070\163\001\232\313\047\262\163\007\045\345\274\013\160\163\207"
	"\131\137\223\327\075\166\111\055\113\337\072\057\263\243\276\353"
	"\027\300\205\343\347\070\126\356\135\073\253\150\254\036\360\005"
	"\176\203\334\273\372\045\350\105\005\043\165\270\307\064\244\337"
	"\364\052\302\334\142\030\313\277\124\166\050\000\224\030\006\022"
	"\234\342\315\226\010\266\334\015\332\121\305\241\206\151\200\172"
	"\223\103\126\366\134\041\266\260\230\336\261\054\367\267\076\223"
	"\232\014\052\242\302\006\260\235\130\165\076\337\337\277\131\162"
	"\003\260\151\137\322\037\017\152\375\301\226\365\170\325\211\023"
	"\341\263\265\244\272\145\101\023\333\200\362\272\100\114\055\103"
	"\375\226\242\317\265\262\072\263\164\320\251\354\246\062\377\207"
	"\346\265\054\240\033\155\264\366\355\247\261\056\363\336\161\360"
	"\165\024\300\053\307\372\336\073\313\207\050\161\272\050\371\240"
	"\336\045\101\371\222\365\360\200\235\241\256\220\200\040\201\365"
	"\065\101\040\375\073\377\071\007\207\142\170\101\213\161\342\151"
	"\226\043\142\051\031\123\251\266\364\130\107\164\171\310\152\257"
	"\012\213\255\106\212\346\115\021\110\305\123\323\067\065\075\316"
	"\131\312\245\314\231\043\226\272\353\305\116\355\334\002\132\020"
	"\055\140\153\012\032\375\371\251\143\230\203\112\152\303\236\360"
	"\144\167\034\064\321\237\051\204\325\350\164\350\340\162\034\301"
	"\006\340\326\145\146\375\310\241\340\347\255\166\164\270\265\273"
	"\362\220\035\215\060\304\231\317\074\337\126\345\316\005\017\234"
	"\021\166\000\204\376\344\240\111\012\215\327\246\155\371\037\161"
	"\235\046\023\362\133\256\047\321\254\332\232\324\361\224\037\023"
	"\226\023\027\145\264\066\303\324\144\160\311\156\052\124\115\105"
	"\346\263\011\151\237\377\104\267\024\363\211\077\343\043\357\234"
	"\244\103\014\312\035\115\156\144\025\170\376\137\110\060\025\347"
	"\261\063\144\065\027\075\005\171\221\250\200\070\371\045\221\233"
	"\245\170\037\064\302\003\260\134\270\103\137\260\060\360\204\354"
	"\370\115\367\146\021\324\210\352\203\353\326\133\154\052\032\057"
	"\347\130\226\233\017\366\144\256\271\075\074\352\237\222\132\164"
	"\124\315\067\117\203\164\130\240\253\017\044\365\215\145\247\244"
	"\025\245\074\110\233\067\066\123\000\255\004\075\146\324\041\375"
	"\074\013\367\310\256\244\076\365\177\020\024\362\206\003\307\241"
	"\142\143\065\057\362\066\230\303\113\031\300\010\043\303\343\335"
	"\317\237\107\251\030\370\032\304\146\121\043\235\006\062\161\375"
	"\206\221\004\237\347\113\124\361\337\131\154\232\330\340\327\233"
	"\136\010\011\315\046\020\211\253\205\103\331\060\150\027\247\103"
	"\151\177\176\071\203\272\126\024\275\211\022\302\360\021\060\101"
	"\246\217\165\005\313\346\312\043\120\016\007\243\165\246\131\341"
	"\360\343\321\052\111\105\042\277\147\012\223\036\015\021\334\017"
	"\130\052\265\300\333\315\015\104\274\150\260\366\020\160\157\056"
	"\356\353\276\230\034\026\255\372\176\214\051\276\354\032\250\204"
	"\206\054\370\261\333\370\020\026\015\267\170\276\243\306\036\250"
	"\354\067\367\026\054\107\101\323\237\120\155\153\250\014\256\060"
	"\200\015\224\320\127\255\273\360\223\302\022\376\226\144\042\323"
	"\350\155\271\351\261\056\370\371\126\216\143\151\267\250\171\321"
	"\066\206\024\211\242\005\274\073\160\132\016\075\350\050\302\162"
	"\152\255\234\316\225\006\101\346\065\010\244\274\034\301\343\217"
	"\054\072\257\266\256\027\321\234\207\227\345\076\137\166\137\306"
	"\132\264\140\317\157\264\356\301\056\374\364\126\060\115\325\071"
	"\273\334\076\200\334\246\136\225\244\056\154\332\377\024\346\237"
	"\233\045\077\060\154\156\102\110\154\363\272\342\171\273\316\253"
	"\265\240\034\041\342\233\346\301\212\073\155\270\002\271\157\143"
	"\376\103\257\027\241\237\120\242\202\263\007\201\251\235\144\017"
	"\204\335\234\252\027\360\316\176\376\203\362\143\034\345\025\216"
	"\214\173\366\365\344\023\177\274\111\312\266\020\364\353\215\060"
	"\077\165\157\354\360\337\015\302\051\330\137\076\220\360\364\036"
	"\155\023\130\254\025\061\070\240\217\046\374\041\372\066\033\160"
	"\312\113\230\222\211\316\055\177\107\271\257\230\011\015\263\054"
	"\355\063\370\152\223\057\260\055\101\212\251\034\355\031\330\234"
	"\145\361\357\021\074\201\311\320\266\325\042\373\210\060\354\044"
	"\054\355\202\246\206\111\365\354\325\336\351\336\042\351\375\255"
	"\261\234\202\356\263\012\215\334\106\242\322\232\113\146\167\044"
	"\276\007\301\142\304\152\212\270\312\234\340\360\271\220\102\072"
	"\303\312\065\313\373\302\205\316\026\324\164\337\003\377\050\063"
	"\107\345\306\371\173\101\360\031\177\304\363\021\163\365\225\231"
	"\360\211\327\101\310\235\321\064\054\120\154\120\063\151\045\337"
	"\202\326\376\127\134\330\067\011\215\241\004\264\303\036\062\267"
	"\125\250\141\204\222\117\222\145\122\052\253\034\327\002\305\006"
	"\351\033\265\100\142\220\075\055\046\232\105\316\165\125\027\264"
	"\100\277\043\211\073\141\337\217\232\377\247\244\056\234\034\274"
	"\155\261\325\217\075\116\017\010\226\045\100\120\330\006\237\133"
	"\134\256\376\140\030\130\016\270\223\147\064\326\014\370\163\035"
	"\124\256\361\212\042\175\205\125\371\042\136\365\054\353\337\325"
	"\031\144\015\336\327\363\030\316\104\074\101\053\351\105\115\107"
	"\351\243\243\343\264\235\275\066\107\160\103\350\371\135\351\054"
	"\305\233\236\357\027\000\245\361\002\053\147\135\061\050\270\136"
	"\252\130\267\246\035\012\016\276\057\237\343\312\341\317\350\104"
	"\007\213\226\250\235\355\256\340\266\270\310\100\215\360\206\174"
	"\074\166\021\100\356\377\144\307\204\264\263\250\374\035\200\264"
	"\131\246\325\360\204\020\105\330\364\243\133\267\136\067\006\130"
	"\020\105\203\277\236\353\022\232\137\024\214\070\017\107\204\203"
	"\370\207\007\256\004\027\334\240\207\331\115\271\234\227\107\136"
	"\031\245\133\127\367\354\023\134\174\202\367\343\275\175\002\122"
	"\340\135\227\005\327\012\262\347\062\025\017\146\044\214\267\323"
	"\144\331\143\157\344\146\267\243\141\321\024\364\272\240\354\021"
	"\164\011\173\343\246\143\245\151\367\065\157\147\375\220\351\374"
	"\125\141\051\122\135\152\053\023\255\100\013\157\230\336\104\111"
	"\147\227\021\350\250\347\053\211\232\037\205\344\134\105\110\313"
	"\333\010\327\266\051\240\125\100\076\120\372\351\213\065\117\076"
	"\324\171\233\146\051\171\116\134\002\062\320\212\166\171\214\251"
	"\307\102\143\047\034\331\306\172\373\163\176\177\045\336\161\320"
	"\161\246\317\103\302\045\103\376\314\340\230\115\347\100\307\140"
	"\012\102\344\247\366\170\220\065\113\154\314\354\133\221\315\030"
	"\275\155\170\147\120\015\243\176\175\336\062\076\002\313\174\062"
	"\342\362\236\224\160\371\114\144\342\007\347\376\176\154\324\211"
	"\271\305\016\237\064\247\146\145\070\247\222\252\256\371\041\025"
	"\260\007\231\005\317\254\131\201\046\064\325\214\274\224\062\057"
	"\112\050\002\326\314\235\321\305\173\105\071\120\143\233\236\365"
	"\065\237\062\066\041\322\363\263\164\335\261\040\135\044\216\365"
	"\223\174\140\063\004\341\327\153\202\144\361\015\301\236\104\045"
	"\343\320\241\035\330\262\331\362\242\047\267\324\156\052\022\031"
	"\103\320\373\256\072\214\036\335\175\165\223\250\071\135\327\156"
	"\013\216\347\025\162\123\371\230\063\304\217\171\274\367\116\075"
	"\107\344\066\200\112\246\112\025\135\271\031\210\273\076\276\375"
	"\264\151\037\041\305\101\240\006\002\037\333\253\052\015\175\261"
	"\360\013\346\113\206\145\336\046\170\113\067\153\011\071\317\237"
	"\317\251\241\014\214\226\137\176\075\124\105\217\020\276\241\357"
	"\120\333\270\044\167\062\071\233\116\260\360\245\150\132\345\176"
	"\141\046\224\034\316\223\360\020\160\223\234\023\344\014\340\344"
	"\102\003\210\171\075\315\313\323\250\052\053\323\267\306\235\300"
	"\001\374\016\024\020\246\273\024\374\011\312\002\115\355\340\270"
	"\017\307\257\037\035\016\340\232\105\053\174\024\021\120\354\141"
	"\152\210\034\203\176\366\104\264\236\205\076\130\253\064\132\221"
	"\343\146\001\076\300\033\014\107\262\320\216\175\150\160\316\133"
	"\341\144\047\127\172\144\354\226\267\131\374\042\130\077\375\152"
	"\303\037\073\021\021\157\030\003\166\070\226\376\347\302\221\012"
	"\234\372\134\145\200\167\357\107\323\070\341\364\172\346\063\177"
	"\040\051\201\062\200\146\241\333\032\033\154\062\143\271\032\227"
	"\042\001\310\377\255\157\134\333\004\345\140\115\030\032\236\210"
	"\337\222\057\167\143\214\200\132\317\251\357\326\237\274\067\216"
	"\341\016\120\227\311\360\343\054\200\227\224\304\272\300\302\147"
	"\302\013\177\001\340\020\047\076\036\140\360\073\343\055\367\371"
	"\125\011\243\167\377\032\343\231\035\136\023\141\033\133\136\352"
	"\244\375\243\117\225\277\044\121\076\320\010\001\350\007\150\056"
	"\051\047\220\012\177\336\002\126\245\141\210\000\222\373\214\104"
	"\152\177\314\001\203\304\355\335\057\141\024\333\327\212\244\070"
	"\240\014\110\354\373\234\060\221\240\071\276\374\207\070\142\060"
	"\064\222\140\063\025\241\105\353\146\274\021\053\164\273\131\010"
	"\321\125\055\027\152\221\101\144\204\013\071\134\104\224\116\044"
	"\372\137\044\343\230\337\033\174\113\313\032\077\211\060\115\234"
	"\315\223\355\251\242\371\023\305\232\247\104\160\201\131\112\344"
	"\300\032\322\114\030\006\044\037\237\015\313\006\175\206\302\221"
	"\162\312\071\372\020\026\213\057\033\100\153\376\223\102\110\054"
	"\327\066\137\265\246\146\107\242\115\104\237\120\266\136\312\061"
	"\300\341\025\145\232\315\103\113\015\333\150\271\320\225\346\244"
	"\206\315\014\065\203\363\120\243\201\220\131\265\037\102\264\303"
	"\261\113\075\107\041\075\051\125\260\277\206\067\146\063\071\227"
	"\071\351\347\376\352\354\326\115\146\024\305\146\214\241\035\305"
	"\344\226\021\142\061\224\030\244\116\041\232\331\341\214\131\052"
	"\147\253\071\216\273\334\364\007\135\117\140\253\106\060\013\367"
	"\234\164\223\306\025\041\076\164\315\131\154\073\343\020\072\242"
	"\305\111\226\305\100\034\221\256\022\317\342\200\222\014\036\360"
	"\144\071\227\253\214\206\124\064\036\137\236\157\307\004\146\175"
	"\112\371\123\270\253\107\251\013\227\353\205\124\214\226\272\326"
	"\325\326\300\130\204\372\206\155\156\217\204\162\276\167\102\363"
	"\175\361\232\000\113\346\367\035\024\322\145\224\346\326\317\137"
	"\155\207\177\357\272\177\302\245\210\125\011\036\207\235\137\047"
	"\053\013\136\045\115\123\354\303\370\274\376\272\167\114\326\010"
	"\077\036\362\062\022\146\101\367\340\014\031\011\333\153\263\051"
	"\342\014\011\075\342\056\231\100\130\005\305\317\137\103\370\323"
	"\030\252\113\024\051\136\125\371\204\062\127\251\264\315\255\171"
	"\177\260\220\326\266\360\302\240\101\370\043\065\071\127\140\223"
	"\345\275\077\002\263\210\235\360\353\032\332\171\153\302\234\200"
	"\336\000\150\001\247\241\172\003\070\072\144\067\146\260\170\261"
	"\264\031\307\114\225\042\161\363\260\274\217\006\057\033\022\070"
	"\154\266\220\225\312\172\041\322\301\325\156\336\057\246\314\346"
	"\254\031\010\357\210\333\045\317\127\256\212\126\271\260\037\002"
	"\262\161\254\012\136\061\154\033\070\001\155\236\150\037\132\350"
	"\277\066\201\040\112\072\204\321\305\122\275\032\156\035\036\306"
	"\062\011\010\031\360\117\356\170\020\027\000\303\213\261\153\075"
	"\145\303\211\171\363\060\063\154\242\077\201\150\034\273\323\240"
	"\214\151\372\324\340\155\151\176\015\100\347\325\075\306\052\172"
	"\003\171\243\303\103\314\354\320\311\350\130\227\156\332\271\054"
	"\125\076\326\014\256\374\375\166\107\147\025\370\257\236\173\111"
	"\111\015\247\071\004\265\106\364\372\070\357\244\317\212\045\043"
	"\076\072\214\210\352\077\310\021\213\143\052\356\311\231\030\334"
	"\277\077\147\270\277\122\004\343\073\006\374\254\166\332\300\206"
	"\156\311\072\000\361\053\033\013\355\051\107\271\050\031\136\265"
	"\276\124\231\045\155\200\250\257\217\017\317\104\210\277\253\277"
	"\103\277\027\305\226\333\320\056\277\200\122\050\020\137\164\333"
	"\222\101\001\332\352\066\227\314\367\136\356\223\234\336\244\316"
	"\076\240\026\072\256\042\144\130\172\265\013\345\164\052\273\354"
	"\203\342\215\350\117\125\333\017\362\363\157\255\352\012\105\330"
	"\377\074\152\165\241\267\056\277\332\042\221\063\240\040\322\114"
	"\362\024\160\163\373\022\242\145\050\312\365\337\334\271\215\166"
	"\375\251\042\174\052\206\243\343\174\027\305\260\340\014\051\005"
	"\135\136\243\121\241\013\107\073\174\223\106\062\067\331\340\075"
	"\270\203\332\224\201\214\335\225\146\326\225\244\144\122\261\152"
	"\064\003\141\150\032\021\000\263\375\243\007\214\316\375\240\157"
	"\376\010\332\370\253\040\313\262\137\036\077\335\157\123\132\074"
	"\033\063\346\110\260\041\072\145\152\103\147\111\207\110\151\165"
	"\101\252\177\215\336\203\322\067\021\227\257\156\061\073\050\142"
	"\206\313\224\050\371\112\006\001\032\027\000\274\267\003\210\040"
	"\311\030\220\153\003\000\171\261\355\000\324\370\220\104\000\070"
	"\155\247\331\110\142\011\342\041\307\335\176\126\224\234\146\362"
	"\103\134\214\346\146\044\100\127\371\256\274\143\143\312\365\053"
	"\215\124\324\217\306\214\376\260\304\220\102\007\057\333\307\021"
	"\163\327\261\235\332\345\166\027\000\276\030\004\177\326\150\003"
	"\256\301\300\101\040\017\300\035\066\072\276\342\114\154\124\053"
	"\204\032\104\052\140\374\233\164\054\137\122\364\025\217\056\352"
	"\124\165\212\120\047\340\113\032\071\203\334\157\053\375\064\344"
	"\351\364\122\362\006\345\133\366\072\117\206\115\262\236\355\110"
	"\103\125\134\233\137\317\304\024\260\271\325\370\016\116\052\305"
	"\236\142\121\371\030\125\170\206\100\057\077\202\116\257\353\147"
	"\133\050\321\355\061\250\164\302\104\116\326\023\025\065\355\174"
	"\047\056\217\346\067\114\274\316\344\001\006\262\207\074\270\210"
	"\362\011\162\077\153\365\376\377\225\324\000\027\310\267\377\276"
	"\246\126\174\226\220\027\151\206\262\166\233\135\341\307\055\113"
	"\136\030\144\225\354\044\323\177\117\205\017\371\237\351\035\303"
	"\263\213\153\076\112\010\033\146\107\122\125\243\235\034\071\362"
	"\005\076\154\263\241\022\006\122\136\231\340\025\107\171\351\075"
	"\155\017\237\324\016\260\046\302\374\267\377\373\256\342\371\344"
	"\115\270\313\153\137\057\213\207\113\022\110\223\250\045\112\175"
	"\130\042\223\356\014\316\215\311\103\072\010\001\267\030\111\357"
	"\032\355\024\122\162\077\067\001\254\225\044\020\125\355\262\171"
	"\162\114\123\104\362\343\315\245\302\354\006\236\061\237\236\201"
	"\366\333\165\372\226\343\040\107\057\276\141\050\277\232\361\337"
	"\204\310\330\307\170\276\200\023\037\325\001\132\073\320\067\375"
	"\045\102\252\004\030\237\360\160\142\171\026\026\361\105\356\364"
	"\055\230\044\100\240\233\106\262\101\332\226\144\211\314\375\227"
	"\174\026\323\034\240\075\014\131\070\117\331\044\240\002\151\135"
	"\121\200\012\206\300\206\216\355\271\246\166\062\004\177\153\201"
	"\304\275\112\042\163\027\223\212\362\346\165\055\167\324\071\127"
	"\325\126\236\336\272\347\261\262\256\235\044\325\155\170\075\361"
	"\374\252\376\333\307\255\013\116\121\256\103\162\260\163\173\121"
	"\104\074\127\270\326\122\003\240\045\366\340\256\340\224\370\237"
	"\175\152\243\350\250\072\134\375\344\111\373\347\344\136\302\071"
	"\364\317\207\175\041\002\265\330\137\302\057\047\373\124\234\217"
	"\073\017\250\041\132\160\054\362\307\016\270\374\307\016\073\045"
	"\052\002\070\144\033\023\175\174\267\045\242\135\356\122\375\047"
	"\057\071\330\320\322\352\363\311\154\344\056\057\063\001\257\317"
	"\157\062\171\227\240\175\353\366\130\070\332\314\264\057\216\332"
	"\135\261\321\135\360\027\267\343\267\307\156\156\361\144\232\101"
	"\153\074\103\352\251\344\147\163\043\047\030\222\031\016\254\226"
	"\317\040\253\104\272\377\356\064\303\145\346\366\270\265\023\214"
	"\034\335\351\367\105\203\213\012\144\152\211\264\223\331\351\137"
	"\113\171\213\203\235\142\334\070\324\031\365\342\310\234\373\253"
	"\124\232\214\156\201\312\101\257\042\024\003\074\046\041\102\003"
	"\135\150\367\030\272\251\075\342\222\000\171\157\164\133\334\057"
	"\063\254\301\074\125\353\271\233\337\356\103\165\217\005\146\242"
	"\377\312\216\105\247\123\304\020\241\046\263\012\345\271\204\170"
	"\302\071\044\131\204\325\354\340\332\317\227\157\243\112\032\302"
	"\305\075\360\327\140\267\076\025\174\030\315\025\324\263\110\154"
	"\270\374\224\207\322\256\246\036\320\005\260\167\377\065\210\135"
	"\373\246\104\263\133\340\351\023\014\320\170\001\240\377\250\346"
	"\271\127\257\264\307\320\253\050\313\061\066\356\122\217\165\211"
	"\020\017\061\004\134\334\130\176\202\354\225\361\112\037\103\236"
	"\323\000\105\134\175\023\024\245\111\045\342\360\115\311\163\125"
	"\327\321\346\225\310\130\324\265\275\206\074\126\126\062\050\044"
	"\114\367\267\107\057\346\103\261\234\304\127\354\166\276\100\165"
	"\215\266\122\362\054\112\173\174\377\054\123\050\140\250\061\217"
	"\055\331\016\134\127\317\306\156\144\164\044\214\076\044\234\357"
	"\130\240\236\060\234\200\113\060\032\312\201\244\225\270\101\147"
	"\376\037\014\124\215\374\113\327\351\001\300\311\134\334\043\277"
	"\012\201\020\265\022\271\302\132\355\306\157\217\327\212\030\333"
	"\056\112\041\012\126\266\353\003\045\227\244\321\346\237\171\302"
	"\112\160\002\050\144\111\234\315\300\355\157\125\206\213\230\225"
	"\171\326\047\076\117\361\136\023\055\231\017\212\112\137\145\204"
	"\267\172\127\251\102\371\100\377\363\177\142\135\063\010\102\027"
	"\131\231\122\332\141\060\111\136\263\157\144\276\060\374\011\031"
	"\342\123\265\004\102\255\202\315\356\364\353\031\303\262\171\135"
	"\223\351\361\144\371\113\307\272\034\245\273\102\015\060\246\212"
	"\301\004\021\167\034\152\026\334\335\240\310\215\351\235\046\006"
	"\023\015\320\255\161\212\024\224\366\203\131\353\361\251\333\345"
	"\114\107\204\074\045\322\010\067\336\262\046\074\224\252\351\120"
	"\176\334\346\367\323\203\256\255\323\245\277\124\177\367\327\304"
	"\225\144\167\052\047\006\046\121\055\066\037\266\355\076\140\330"
	"\360\345\321\373\124\334\136\301\210\176\012\012\144\263\134\261"
	"\173\025\040\244\137\332\123\110\357\074\122\367\203\051\007\024"
	"\043\165\263\145\040\232\043\336\170\360\016\232\343\061\162\127"
	"\073\164\163\214\315\224\276\124\350\333\134\035\010\173\331\034"
	"\214\126\055\310\003\216\313\047\231\034\356\163\142\334\231\313"
	"\343\173\221\176\347\247\202\005\027\121\022\155\064\172\140\152"
	"\166\116\176\305\171\361\045\304\334\137\273\133\125\221\335\353"
	"\066\075\315\214\272\231\150\334\007\274\004\271\236\001\214\107"
	"\147\167\307\357\377\253\342\235\330\225\117\201\274\154\324\364"
	"\223\225\143\052\070\264\367\170\024\234\356\127\160\366\266\122"
	"\240\051\141\046\123\237\277\117\217\007\364\127\347\336\124\214"
	"\372\377\370\354\041\373\170\357\354\002\117\043\111\101\032\047"
	"\372\035\122\103\126\356\004\100\323\163\045\153\146\276\051\037"
	"\366\125\132\116\070\037\167\063\106\266\205\311\340\137\030\141"
	"\360\250\312\222\217\177\067\151\062\145\265\136\202\334\243\014"
	"\106\134\373\041\106\003\211\141\272\330\162\032\206\326\053\062"
	"\231\211\004\025\217\343\025\117\337\234\025\373\220\271\145\351"
	"\174\211\024\310\145\136\010\101\175\336\225\035\331\203\362\076"
	"\244\315\023\227\064\216\255\160\061\352\367\364\122\351\272\054"
	"\264\024\341\364\367\213\013\353\076\370\325\310\321\035\316\232"
	"\134\311\015\371\230\141\076\006\025\251\142\312\361\354\132\107"
	"\213\006\356\124\002\301\360\127\220\245\233\106\232\321\061\014"
	"\205\341\267\036\110\357\237\244\033\041\310\274\113\274\174\230"
	"\234\173\040\257\266\274\110\120\175\121\125\027\202\213\361\363"
	"\242\073\055\347\261\247\326\350\125\262\203\010\043\345\326\353"
	"\316\317\125\350\352\214\042\223\334\242\333\324\253\316\013\255"
	"\143\346\236\215\365\100\356\050\261\333\201\331\355\272\241\207"
	"\023\130\057\301\247\244\231\326\352\306\227\005\357\345\051\360"
	"\132\121\203\221\142\144\147\320\162\273\335\132\017\066\311\161"
	"\353\041\211\031\165\024\176\153\356\227\011\262\263\327\041\272"
	"\355\265\065\135\070\244\365\010\313\162\200\170\037\111\264\153"
	"\351\024\333\106\101\330\306\055\232\202\057\275\324\176\175\136"
	"\102\333\061\363\154\063\164\060\021\207\361\052\070\174\140\110"
	"\034\161\061\200\220\206\113\204\325\161\257\165\371\031\264\231"
	"\347\052\053\137\005\161\365\162\361\104\251\032\116\164\147\301"
	"\073\307\253\346\210\250\032\362\306\105\310\077\156\114\171\127"
	"\127\166\375\133\160\234\004\133\272\114\004\031\367\361\114\150"
	"\115\004\355\064\257\044\345\254\305\355\045\301\312\344\051\111"
	"\224\144\337\122\173\367\252\341\355\044\003\245\021\237\337\057"
	"\275\314\211\013\006\066\164\141\125\044\370\156\204\276\315\327"
	"\163\370\335\327\235\132\325\010\236\075\174\260\126\305\104\351"
	"\166\225\305\372\040\127\276\051\134\050\275\223\121\130\056\065"
	"\004\151\114\036\312\126\211\337\361\363\111\217\052\245\142\213"
	"\375\375\217\136\044\373\214\376\335\241\117\303\300\265\304\005"
	"\265\374\222\303\335\350\300\375\342\225\246\155\151\121\037\165"
	"\134\214\071\014\171\217\253\374\322\146\324\030\332\111\122\101"
	"\315\206\302\075\307\061\011\005\323\077\137\331\211\066\261\222"
	"\047\045\347\206\130\067\130\234\202\353\216\136\151\352\220\133"
	"\027\311\004\024\107\242\077\340\011\231\113\103\153\072\135\100"
	"\212\105\151\341\130\374\033\161\172\044\245\065\120\344\155\331"
	"\020\216\144\152\303\133\152\071\207\101\323\221\021\077\144\033"
	"\112\112\071\132\206\014\146\252\106\363\054\242\141\253\162\176"
	"\110\235\033\242\072\140\365\377\143\033\202\065\037\220\144\333"
	"\032\056\160\365\352\055\251\216\271\247\213\237\027\072\177\261"
	"\151\253\073\035\075\114\271\317\223\044\272\116\042\312\365\153"
	"\170\174\270\142\073\057\355\072\277\036\162\121\372\077\322\072"
	"\117\075\120\365\327\072\221\210\134\225\155\000\236\115\232\071"
	"\253\057\111\150\216\236\261\042\216\364\061\237\366\242\162\076"
	"\227\170\130\041\232\333\002\130\136\226\364\105\065\310\230\266"
	"\205\053\251\372\244\321\370\150\001\343\022\213\142\055\271\206"
	"\055\057\335\210\243\357\163\175\257\320\162\374\246\102\221\242"
	"\107\360\271\323\031\114\223\245\301\104\171\351\101\372\217\151"
	"\042\073\306\033\147\251\040\102\357\344\251\021\217\237\153\267"
	"\233\356\001\000\302\243\174\166\322\223\012\221\356\200\041\154"
	"\013\335\357\231\227\160\101\222\025\132\272\267\040\141\222\324"
	"\253\342\312\213\144\123\216\226\175\224\133\277\226\363\215\374"
	"\060\315\156\205\231\002\050\017\342\066\271\371\253\043\243\025"
	"\324\164\031\232\201\261\221\276\041\175\175\275\001\344\160\023"
	"\020\300\317\324\037\352\356\223\074\367\057\202\176\370\310\312"
	"\161\266\255\040\132\254\053\175\133\201\263\041\212\113\177\305"
	"\046\204\052\121\300\172\365\231\027\001\154\065\127\035\066\070"
	"\054\033\335\155\001\206\353\027\237\114\052\223\047\273\153\223"
	"\313\244\137\002\060\224\266\315\315\005\062\020\376\151\150\376"
	"\005\376\116\222\067\332\327\146\013\024\014\074\063\137\144\135"
	"\316\132\304\113\232\262\372\366\123\310\110\132\250\343\111\074"
	"\254\213\361\076\102\100\041\350\244\271\074\227\266\050\317\125"
	"\134\224\052\310\304\032\024\334\072\042\206\321\126\241\172\131"
	"\323\341\325\004\017\113\360\107\275\320\174\256\166\277\060\015"
	"\140\342\112\164\360\333\314\152\033\055\275\337\060\274\277\304"
	"\145\227\345\376\012\262\356\037\222\324\155\162\157\274\235\263"
	"\122\215\222\147\263\110\323\173\237\161\147\115\271\221\077\056"
	"\166\032\050\252\232\043\103\174\137\236\121\371\111\264\050\311"
	"\375\152\356\007\314\203\142\253\267\364\346\057\144\326\303\364"
	"\276\210\211\222\213\051\233\241\050\116\112\273\234\145\126\001"
	"\017\201\135\210\216\006\340\356\223\255\362\066\040\337\041\267"
	"\017\174\263\174\335\340\254\224\274\134\225\363\334\146\120\347"
	"\341\142\211\302\064\061\371\130\013\324\212\124\355\315\053\321"
	"\374\240\323\255\027\350\216\174\147\230\237\225\324\116\100\236"
	"\347\010\272\170\021\212\224\254\212\100\307\207\101\142\226\033"
	"\034\362\020\346\326\017\313\051\364\247\333\311\004\154\007\007"
	"\260\063\074\120\356\364\055\260\147\210\047\363\150\267\263\042"
	"\210\151\131\272\200\042\260\160\335\240\305\041\176\146\012\370"
	"\146\225\353\237\317\131\106\357\321\027\124\247\033\117\240\042"
	"\141\166\256\357\121\267\371\365\366\162\320\164\374\146\222\017"
	"\320\355\173\345\132\331\060\341\144\257\370\273\014\012\062\222"
	"\272\314\150\212\064\125\272\162\131\255\224\174\113\010\257\334"
	"\327\165\067\376\053\362\377\230\347\167\346\243\152\142\110\332"
	"\245\103\350\244\024\205\242\224\330\042\146\063\121\004\000\013"
	"\154\025\327\262\004\303\164\176\153\125\205\356\110\211\164\325"
	"\145\254\174\243\363\170\065\164\320\024\242\112\311\022\322\041"
	"\107\061\260\155\173\142\305\314\342\150\203\126\242\032\036\016"
	"\336\363\062\307\202\170\341\036\252\212\330\102\211\104\127\277"
	"\213\367\352\130\346\203\263\233\050\104\065\240\062\215\024\376"
	"\023\331\252\347\334\215\361\354\034\057\116\140\072\303\100\320"
	"\142\172\357\040\001\146\002\371\003\263\016\216\057\333\006\064"
	"\145\343\004\246\172\056\313\330\170\310\273\325\255\242\250\070"
	"\376\273\226\012\136\371\276\236\132\304\222\252\005\264\142\121"
	"\126\174\032\200\053\367\030\213\173\340\105\124\020\112\232\010"
	"\015\034\352\056\022\175\121\103\162\202\076\061\260\047\270\172"
	"\150\170\203\370\132\100\274\006\366\002\155\133\226\117\135\264"
	"\371\221\103\260\063\311\256\343\216\232\131\020\152\017\055\113"
	"\253\000\210\024\172\216\102\116\275\042\007\221\147\163\275\040"
	"\217\013\360\361\230\272\136\103\347\367\055\366\361\003\231\050"
	"\371\134\257\070\162\076\260\224\261\053\206\315\235\326\362\112"
	"\247\037\073\236\104\236\045\121\116\152\051\174\126\202\220\335"
	"\170\250\037\311\315\033\137\335\036\032\365\110\143\014\221\067"
	"\175\153\036\011\240\370\046\136\263\142\020\003\121\026\220\205"
	"\370\345\031\123\050\040\247\325\162\031\311\170\071\320\122\120"
	"\255\141\276\336\166\010\333\233\275\032\123\354\165\114\363\223"
	"\366\107\337\266\217\140\005\350\211\323\174\240\026\047\267\172"
	"\334\006\255\140\375\076\256\061\003\353\163\065\076\060\365\256"
	"\147\271\040\232\137\016\073\107\137\313\161\135\006\001\253\102"
	"\131\256\156\364\110\276\253\071\121\352\234\222\111\070\377\272"
	"\275\131\113\365\334\311\217\106\252\037\241\012\014\351\111\245"
	"\202\147\251\307\306\202\165\375\121\140\056\205\025\017\243\045"
	"\344\341\034\212\371\070\012\352\072\325\015\262\164\320\371\124"
	"\004\231\373\226\103\324\002\336\375\057\263\224\076\303\254\031"
	"\270\174\330\343\116\057\307\174\147\317\255\346\104\260\376\014"
	"\100\375\174\323\002\122\306\330\346\247\233\272\151\051\144\303"
	"\104\105\350\212\105\267\224\366\272\232\300\047\162\140\237\344"
	"\271\063\161\333\155\045\212\340\143\053\001\302\276\260\337\070"
	"\157\331\266\243\117\346\022\063\327\153\314\150\051\015\365\376"
	"\337\123\345\324\250\347\035\104\333\133\240\367\162\363\241\051"
	"\350\372\160\135\164\070\307\043\102\122\321\211\335\267\326\357"
	"\000"
#define      opts_z	1
#define      opts	((&data[7239]))
	"\104"
#define      tst2_z	19
#define      tst2	((&data[7242]))
	"\241\321\213\322\172\244\351\241\114\167\006\203\365\372\172\056"
	"\260\254\316\244\215"
#define      chk2_z	19
#define      chk2	((&data[7263]))
	"\245\072\247\077\376\364\257\013\035\146\060\234\142\064\206\076"
	"\051\024\026\006\236\156"
#define      chk1_z	22
#define      chk1	((&data[7284]))
	"\353\222\006\040\112\340\154\010\313\302\274\273\117\253\267\367"
	"\051\137\043\152\376\171\043\251\027\262\315\132"
#define      pswd_z	256
#define      pswd	((&data[7351]))
	"\342\126\271\321\126\125\024\053\051\215\075\313\137\357\144\243"
	"\225\237\022\043\324\360\016\176\010\301\113\142\307\351\106\251"
	"\077\377\173\226\125\220\302\177\162\172\034\276\111\213\035\204"
	"\006\316\074\304\250\213\270\046\163\132\307\001\161\070\023\133"
	"\126\161\371\034\070\337\301\252\131\336\151\242\151\206\046\160"
	"\124\142\064\375\356\355\044\141\110\353\143\271\043\166\024\172"
	"\350\015\226\040\355\130\313\106\066\064\351\240\273\020\020\020"
	"\163\105\016\141\062\062\302\172\035\046\064\101\234\110\273\204"
	"\126\122\244\103\253\160\212\341\245\163\202\141\204\223\161\367"
	"\330\177\130\012\261\033\205\317\101\271\020\335\002\314\142\130"
	"\036\007\234\311\167\046\253\034\232\055\175\036\300\357\025\231"
	"\157\155\244\041\211\051\360\312\343\001\250\345\315\012\076\354"
	"\022\332\266\211\000\142\246\232\220\044\270\121\024\316\352\203"
	"\074\216\244\305\270\225\217\233\226\067\200\144\102\276\121\124"
	"\231\010\336\231\152\204\064\372\251\355\114\275\273\066\100\367"
	"\305\345\274\175\172\114\030\021\204\231\166\306\130\310\032\361"
	"\320\371\213\073\175\277\066\046\254\202\344\147\271\044\137\176"
	"\011\034\373\204\150\024\226\355\256\014\263\007\325\316\370\245"
	"\307\203\341\105\103\027\154\357\035\377\112\175\357\257\041\204"
	"\116\063\250\043\043\266\241\053\170\354\216\077\326\324\351\026"
	"\324\145\254\051\366\156\251\024\156\363\221\135\243\262\342\362"
	"\345\212\025\011\100\267\064\271\244\303\370\172\227\342\220\153"
	"\107"
#define      shll_z	10
#define      shll	((&data[7665]))
	"\254\115\135\150\217\210\121\066\235\350\024"
#define      inlo_z	3
#define      inlo	((&data[7675]))
	"\167\106\135"
#define      date_z	1
#define      date	((&data[7678]))
	"\112"
#define      msg1_z	65
#define      msg1	((&data[7688]))
	"\307\173\344\335\204\045\225\271\336\315\351\214\245\056\157\247"
	"\226\121\317\017\214\247\044\050\037\047\114\042\220\025\224\104"
	"\100\276\260\322\105\244\376\271\151\204\370\151\226\176\022\012"
	"\206\044\113\033\355\236\040\245\213\206\175\112\203\170\242\217"
	"\374\200\342\245\166\335\014\366\317\075\071\174\327\264\023"
#define      xecc_z	15
#define      xecc	((&data[7759]))
	"\000\161\006\011\014\117\162\370\165\225\145\013\076\237\101\072"
	"\202"
#define      lsto_z	1
#define      lsto	((&data[7775]))
	"\302"
#define      tst1_z	22
#define      tst1	((&data[7779]))
	"\205\163\301\247\301\176\370\067\170\024\140\002\321\327\104\034"
	"\160\061\274\150\374\154\132\260\306\132"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * clang -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/data/data/com.termux/files/usr/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "clang";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/data/data/com.termux/files/usr/tmp/shc_x.so", "/data/data/com.termux/files/usr/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/data/data/com.termux/files/usr/tmp/shc_x.c"); return -1;}
	remove("/data/data/com.termux/files/usr/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/data/data/com.termux/files/usr/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/data/data/com.termux/files/usr/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
